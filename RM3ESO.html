<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicon añadido -->
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <title>Plan Interactivo de Razonamiento Matemático - 3º ESO</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #F8F9FA;
            color: #343A40;
        }
        .filter-btn {
            transition: all 0.2s ease-in-out;
        }
        .filter-btn.active {
            transform: translateY(-2px);
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -2px rgba(0, 0, 0, 0.1);
        }
        .week-card {
            transition: opacity 0.4s ease-in-out, transform 0.4s ease-in-out;
            transform: scale(1);
        }
        .week-card.filtered-out {
            opacity: 0.15;
            transform: scale(0.98);
        }
        .session-card.highlight {
            transform: scale(1.05);
            box-shadow: 0 0 0 2px #1D4ED8;
        }
        .class-btn {
            background-color: #E2E8F0;
            color: #4A5568;
            border-radius: 9999px;
            padding: 0.375rem 0.75rem;
            font-size: 0.75rem;
            font-weight: 500;
            transition: all 0.2s ease-in-out;
            cursor: pointer;
        }
        .class-btn:hover {
            background-color: #CBD5E0;
        }
    </style>
</head>
<body class="antialiased">
    <div class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

        <header class="text-center mb-10">
            <h1 class="text-3xl md:text-4xl font-bold text-gray-800">Plan de Razonamiento Matemático (3º de ESO)</h1>
            <p class="mt-2 text-lg text-gray-600">Cronograma interactivo para 3º de ESO (36 semanas)</p>
        </header>

        <main>
            <section id="controls" class="mb-12 p-6 bg-white rounded-2xl shadow-sm">
                <div class="mb-6">
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Filtrar por Asignatura</h3>
                    <div id="subject-filters" class="flex flex-wrap gap-2"></div>
                </div>
                <div>
                    <h3 class="text-lg font-semibold text-gray-700 mb-3">Filtrar por Ámbito</h3>
                    <div id="ambito-filters" class="flex flex-wrap gap-2"></div>
                </div>
                 <div class="mt-6 text-center">
                    <button id="reset-filters" class="px-6 py-2 bg-blue-700 text-white font-semibold rounded-lg shadow-md hover:bg-blue-800 focus:outline-none focus:ring-2 focus:ring-blue-600 focus:ring-opacity-75 transition">Mostrar Todo</button>
                </div>
            </section>
            
            <section id="summary" class="mb-12">
                 <div class="bg-white rounded-2xl shadow-sm p-6">
                    <h2 class="text-xl font-bold text-gray-800 text-center mb-4">Distribución Proporcional de Sesiones</h2>
                    <p class="text-center text-gray-600 mb-6 max-w-2xl mx-auto">
                        Este gráfico ilustra la distribución de las sesiones (Sesión 2 y 3) a lo largo del ciclo completo de 36 semanas. La asignación es directamente proporcional a la carga horaria semanal de cada materia, garantizando un reparto equitativo del trabajo interdisciplinar de razonamiento matemático.
                    </p>
                    <div class="chart-container relative w-full max-w-lg mx-auto h-80 md:h-96">
                        <canvas id="proportionalityChart"></canvas>
                    </div>
                </div>
            </section>

            <section id="schedule">
                <h2 class="text-2xl font-bold text-gray-800 text-center mb-8">Cronograma del Curso Escolar Completo</h2>
                <div id="evaluations-container" class="space-y-6">
                    <!-- Primera Evaluación -->
                    <div class="evaluation-section bg-white rounded-2xl shadow-sm overflow-hidden">
                        <button class="w-full text-left p-6 flex justify-between items-center cursor-pointer focus:outline-none" onclick="toggleEvaluation(1)">
                            <h3 class="text-xl font-bold text-gray-800">Primera Evaluación (14 Semanas)</h3>
                            <span id="toggle-icon-1" class="text-2xl font-bold transform transition-transform duration-300">-</span>
                        </button>
                        <div id="evaluation-content-1" class="p-5 border-t border-gray-200 space-y-6">
                            <!-- Las semanas se renderizarán aquí -->
                        </div>
                    </div>
                    <!-- Segunda Evaluación -->
                    <div class="evaluation-section bg-white rounded-2xl shadow-sm overflow-hidden">
                        <button class="w-full text-left p-6 flex justify-between items-center cursor-pointer focus:outline-none" onclick="toggleEvaluation(2)">
                            <h3 class="text-xl font-bold text-gray-800">Segunda Evaluación (11 Semanas)</h3>
                            <span id="toggle-icon-2" class="text-2xl font-bold transform transition-transform duration-300">+</span>
                        </button>
                        <div id="evaluation-content-2" class="p-5 border-t border-gray-200 space-y-6 hidden">
                            <!-- Las semanas se renderizarán aquí -->
                        </div>
                    </div>
                    <!-- Tercera Evaluación -->
                    <div class="evaluation-section bg-white rounded-2xl shadow-sm overflow-hidden">
                        <button class="w-full text-left p-6 flex justify-between items-center cursor-pointer focus:outline-none" onclick="toggleEvaluation(3)">
                            <h3 class="text-xl font-bold text-gray-800">Tercera Evaluación (11 Semanas)</h3>
                            <span id="toggle-icon-3" class="text-2xl font-bold transform transition-transform duration-300">+</span>
                        </button>
                        <div id="evaluation-content-3" class="p-5 border-t border-gray-200 space-y-6 hidden">
                            <!-- Las semanas se renderizarán aquí -->
                        </div>
                    </div>
                </div>
            </section>
        </main>
    </div>

    <script>
        const links3A = {
            1: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B5', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E5', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H5' },
            2: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B9', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E9', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H9' },
            3: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B15', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E15', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H15' },
            4: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B19', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E19', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H19' },
            5: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B23', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E23', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H23' },
            6: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B27', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E27', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H27' },
            7: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B31', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E31', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H31' },
            8: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B37', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E37', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H37' },
            9: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B41', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E41', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H41' },
            10: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B45', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E45', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H45' },
            11: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B49', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E49', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H49' },
            12: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B55', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E55', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H55' },
            13: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B59', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E59', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H59' },
            14: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B63', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E63', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H63' },
            15: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B69', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E69', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H69' },
            16: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B73', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E73', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H73' },
            17: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B77', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E77', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H77' },
            18: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B83', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E83', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H83' },
            19: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B87', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E87', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H87' },
            20: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B91', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E91', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H91' },
            21: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B95', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E95', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H95' },
            22: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B101', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E101', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H101' },
            23: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B105', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E105', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H105' },
            24: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B109', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E109', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H109' },
            25: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B113', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E113', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H113' },
            26: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B119', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E119', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H119' },
            27: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B123', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E123', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H123' },
            28: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B127', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E127', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H127' },
            29: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B131', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E131', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H131' },
            30: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B137', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E137', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H137' },
            31: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B141', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E141', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H141' },
            32: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B145', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E145', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H145' },
            33: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B149', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E149', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H149' },
            34: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B155', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E155', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H155' },
            35: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B159', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E159', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H159' },
            36: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=B163', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=E163', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=458931996#gid=458931996&range=H163' }
        };

        const links3B = {
            1: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B5', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E5', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H5' },
            2: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B9', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E9', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H9' },
            3: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B15', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E15', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H15' },
            4: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B19', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E19', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H19' },
            5: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B23', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E23', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H23' },
            6: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B27', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E27', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H27' },
            7: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B31', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E31', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H31' },
            8: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B37', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E37', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H37' },
            9: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B41', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E41', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H41' },
            10: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B45', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E45', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H45' },
            11: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B49', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E49', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H49' },
            12: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B55', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E55', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H55' },
            13: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B59', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E59', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H59' },
            14: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B63', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E63', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H63' },
            15: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B69', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E69', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H69' },
            16: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B73', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E73', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H73' },
            17: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B77', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E77', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H77' },
            18: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B83', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E83', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H83' },
            19: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B87', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E87', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H87' },
            20: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B91', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E91', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H91' },
            21: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B95', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E95', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H95' },
            22: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B101', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E1011', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H101' },
            23: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B105', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E105', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H105' },
            24: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B109', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E109', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H109' },
            25: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B113', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E113', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H113' },
            26: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B119', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E119', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H119' },
            27: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B123', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E123', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H123' },
            28: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B127', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E127', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H127' },
            29: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B131', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E131', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H131' },
            30: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B137', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E137', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H137' },
            31: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B141', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E141', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H141' },
            32: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B145', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E135', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H145' },
            33: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B149', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E149', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H149' },
            34: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B155', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E155', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H155' },
            35: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B159', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E159', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H159' },
            36: { 1: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=B163', 2: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=E163', 3: 'https://docs.google.com/spreadsheets/d/1QEYC3Hy4nR0dzS8Uil6-c7JkNtDdsvclR-lf_vBhkqA/edit?gid=505288319#gid=505288319&range=H163' }
        };

        const initialLoadDate = new Date();
        const initialMonth = initialLoadDate.getMonth();
        const initialYear = initialLoadDate.getFullYear();
        
        let currentYear = initialYear;
        let currentMonth = initialMonth;
        
        // Ajusta el año y el mes para que la fecha de inicio sea en septiembre
        if (currentMonth < 8) { // Si es de enero a agosto, el año escolar pasado
            currentYear--;
        }
        
        function getDatesForWeek(weekNumber) {
            // Fechas de inicio de cada evaluación
            const firstEvalStart = new Date(currentYear, 8, 15); // Sept 15
            const secondEvalStart = new Date(currentYear + 1, 0, 12); // Jan 12, 2026
            const thirdEvalStart = new Date(currentYear + 1, 3, 6); // Apr 6, 2026

            let startDate;
            if (weekNumber <= 14) {
                // Primera evaluación: del 15 de septiembre. Lunes es el 15.
                startDate = new Date(firstEvalStart);
                startDate.setDate(firstEvalStart.getDate() + (weekNumber - 1) * 7);
            } else if (weekNumber <= 25) {
                // Segunda evaluación: del 12 de enero. Lunes es el 12.
                startDate = new Date(secondEvalStart);
                startDate.setDate(secondEvalStart.getDate() + (weekNumber - 15) * 7);
            } else {
                // Tercera evaluación: del 6 de abril. Lunes es el 6.
                startDate = new Date(thirdEvalStart);
                startDate.setDate(thirdEvalStart.getDate() + (weekNumber - 26) * 7);
            }
            
            const endDate = new Date(startDate);
            endDate.setDate(startDate.getDate() + 4); // Sumar 4 días para que sea de lunes a viernes

            return {
                start: startDate.toLocaleDateString('es-ES', { day: 'numeric', month: 'long' }),
                end: endDate.toLocaleDateString('es-ES', { day: 'numeric', month: 'long' })
            };
        }

        // Función para abrir el enlace correcto en una nueva pestaña
        function openLink(week, session, classId) {
            let links;
            if (classId === '3ºA') {
                links = links3A;
            } else if (classId === '3ºB') {
                links = links3B;
            }
            if (links && links[week] && links[week][session]) {
                window.open(links[week][session], '_blank');
            } else {
                console.error('Enlace no encontrado para la semana, sesión y clase especificadas.', { week, session, classId });
            }
        }
        window.openLink = openLink;


        // Definición de las asignaturas, ámbitos y carga horaria (con Matemáticas descontada para la distribución)
        const subjects = [
            { name: 'Lengua', hours: 4, ambito: 'SL' },
            { name: 'Geografía', hours: 3, ambito: 'SL' },
            { name: 'Inglés', hours: 4, ambito: 'SL' },
            { name: 'Religión', hours: 1, ambito: 'SL' },
            { name: 'Biología y Geología', hours: 3, ambito: 'CT' },
            { name: 'Física y Química', hours: 3, ambito: 'CT' },
            { name: 'Matemáticas', hours: 4, ambito: 'CT' }, // Sin carga en la distribución
            { name: 'Tecnología y Digitalización', hours: 2, ambito: 'CT' },
            { name: 'Computación y Robótica', hours: 2, ambito: 'CT' },
            { name: 'Cultura del Flamenco', hours: 2, ambito: 'AR' },
            { name: 'Educación Plástica', hours: 2, ambito: 'AR' },
            { name: 'Educación Física', hours: 2, ambito: 'AR' }
        ];

        const ambitoCT = subjects.filter(s => s.ambito === 'CT');
        const ambitoARSL = subjects.filter(s => s.ambito === 'AR' || s.ambito === 'SL');
        
        // Carga horaria total para la distribución (sesiones 2 y 3)
        const totalHoursCT = ambitoCT.reduce((sum, s) => s.name !== 'Matemáticas' ? sum + s.hours : sum, 0) + 2; // +2 de Matemáticas para la Sesión 2
        const totalHoursARSL = ambitoARSL.reduce((sum, s) => sum + s.hours, 0);

        // Generar la secuencia proporcional de sesiones para la Sesión 2 (Ámbito CT)
        const ctSubjectsForDistribution = ambitoCT.filter(s => s.name !== 'Matemáticas');
        const ctScheduleSequence = [];
        ctSubjectsForDistribution.forEach(s => {
            const count = Math.round((s.hours + (s.name === 'Matemáticas' ? 2 : 0)) / totalHoursCT * 36 * 1);
            for (let i = 0; i < count; i++) {
                ctScheduleSequence.push(s.name);
            }
        });
        
        // Añadir las 2h de Matemáticas a la sesión 2
        const mathCountSession2 = Math.round(2 / totalHoursCT * 36 * 1);
        for(let i=0; i<mathCountSession2; i++) {
            ctScheduleSequence.push('Matemáticas');
        }

        // Generar la secuencia proporcional de sesiones para la Sesión 3 (Ámbitos AR y SL)
        const arslScheduleSequence = [];
        ambitoARSL.forEach(s => {
            const count = Math.round(s.hours / totalHoursARSL * 36 * 1);
            for (let i = 0; i < count; i++) {
                arslScheduleSequence.push(s.name);
            }
        });

        // Asegurarse de que las secuencias tienen 36 elementos y mezclarlas
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
        }
        while (ctScheduleSequence.length < 36) ctScheduleSequence.push(ctScheduleSequence[Math.floor(Math.random() * ctScheduleSequence.length)]);
        while (arslScheduleSequence.length < 36) arslScheduleSequence.push(arslScheduleSequence[Math.floor(Math.random() * arslScheduleSequence.length)]);
        shuffleArray(ctScheduleSequence);
        shuffleArray(arslScheduleSequence);

        // Mapa de asignaturas a ámbitos y colores
        const subjectDetails = {};
        const subjectColors = {};
        subjects.forEach(s => {
            subjectDetails[s.name] = s.ambito;
            subjectColors[s.name] = `hsl(${Math.random() * 360}, 60%, 50%)`; // Colores dinámicos
        });
        subjectColors['Matemáticas'] = '#1D4ED8'; // Color fijo para matemáticas

        const scheduleData = [];
        for (let i = 0; i < 36; i++) {
            scheduleData.push({
                week: i + 1,
                session1: { subject: 'Matemáticas', ambito: 'CT', activity: 'Resolución de un problema de la vida cotidiana', ce: 'MA.C.E.1.3' },
                session2: { subject: ctScheduleSequence[i], ambito: subjectDetails[ctScheduleSequence[i]], activity: 'Actividad de razonamiento transversal', ce: 'CE_EJEMPLO' },
                session3: { subject: arslScheduleSequence[i], ambito: subjectDetails[arslScheduleSequence[i]], activity: 'Actividad de razonamiento transversal', ce: 'CE_EJEMPLO' }
            });
        }
        
        // Criterios de evaluación (CE) de la Orden de 30 de mayo de 2023 de la Junta de Andalucía
        const ces = {
            'Matemáticas': {
                'MA.C.E.1.3': 'Desarrollar destrezas para la resolución de problemas a partir de la práctica de la reflexión, el análisis y la conexión entre diferentes conceptos.',
                'MA.C.E.2.1': 'Utilizar diferentes estrategias para la resolución de problemas, incluyendo la b'
            },
            'Lengua': {
                'LCL.C.E.1.2': 'Planificar y desarrollar textos escritos atendiendo a la coherencia y cohesión.',
                'LCL.C.E.4.3': 'Reconocer el poder del lenguaje para la construcción de identidades y la creación de consensos y disensos.'
            },
            'Geografía': {
                'GEH.C.E.1.4': 'Analizar patrones de distribución espacial y temporal para explicar fenómenos geográficos, empleando las herramientas y fuentes cartográficas y geotecnológicas adecuadas.'
            },
            'Inglés': {
                'IN.C.E.4.3': 'Organizar, seleccionar y sintetizar información relevante de una variedad de fuentes, impresas y digitales, para responder a tareas específicas.'
            },
            'Religión': {
                'RE.C.E.1.1': 'Analizar los elementos constitutivos de la experiencia religiosa, para descubrir su significado y su sentido personal y social.'
            },
            'Biología y Geología': {
                'BG.C.E.1.1': 'Valorar la importancia de la experimentación y el método científico para la resolución de problemas.',
                'BG.C.E.1.4': 'Interpretar y elaborar gráficos, tablas y mapas para comunicar información científica de manera rigurosa.'
            },
            'Física y Química': {
                'FQ.C.E.1.1': 'Analizar la realidad a través de la observación, el análisis de datos y la interpretación de gráficos y tablas, para comprender el método científico.'
            },
            'Tecnología y Digitalización': {
                'TD.C.E.1.1': 'Identificar y explicar las fases del proceso de resolución de problemas, y aplicarlas a la gestión de proyectos sencillos.'
            },
            'Computación y Robótica': {
                'CR.C.E.1.1': 'Aplicar las habilidades de pensamiento computacional para la resolución de problemas de la vida cotidiana.'
            },
            'Cultura del Flamenco': {
                'FL.C.E.1.3': 'Reconocer y analizar la estructura y la forma de las manifestaciones artísticas del flamenco, valorando su contribución al patrimonio cultural.'
            },
            'Educación Plástica': {
                'VP.C.E.1.4': 'Aplicar los principios de la composición visual, el color y la proporción en la creación artística y visual.'
            },
            'Educación Física': {
                'EF.C.E.1.3': 'Evaluar y mejorar el rendimiento deportivo, a partir del análisis de la condición física y las habilidades motrices.'
            }
        };

        const activityExamples = {
            'Matemáticas': {
                'MA.C.E.1.3': 'Análisis de un problema de la vida cotidiana que implique ecuaciones de primer grado.',
                'MA.C.E.2.1': 'Uso de un diagrama de árbol para representar un problema de combinatoria.'
            },
            'Lengua': {
                'LCL.C.E.1.2': 'Organización de un texto argumentativo sobre un tema de actualidad.',
                'LCL.C.E.4.3': 'Análisis de un discurso para identificar falacias lógicas.'
            },
            'Geografía': {
                'GEH.C.E.1.4': 'Análisis de datos de densidad de población en diferentes países y representación en un gráfico.'
            },
            'Inglés': {
                'IN.C.E.4.3': 'Síntesis de información de dos artículos en inglés para elaborar un resumen estructurado.'
            },
            'Religión': {
                'RE.C.E.1.1': 'Análisis de un texto religioso para identificar la lógica de sus enseñanzas.'
            },
            'Biología y Geología': {
                'BG.C.E.1.1': 'Diseño de un experimento para comprobar una hipótesis sobre el crecimiento de una planta.',
                'BG.C.E.1.4': 'Creación de un gráfico de barras a partir de datos de un ecosistema.'
            },
            'Física y Química': {
                'FQ.C.E.1.1': 'Interpretación de un gráfico de temperatura y tiempo para identificar los cambios de estado de una sustancia.'
            },
            'Tecnología y Digitalización': {
                'TD.C.E.1.1': 'Planificación de un proyecto de diseño, desde la identificación del problema hasta la solución final.'
            },
            'Computación y Robótica': {
                'CR.C.E.1.1': 'Programación de un algoritmo para resolver un laberinto en un simulador de robótica.'
            },
            'Cultura del Flamenco': {
                'FL.C.E.1.3': 'Análisis de la estructura rítmica de una sevillana y su representación con un diagrama de flujo.'
            },
            'Educación Plástica': {
                'VP.C.E.1.4': 'Aplicar los principios de la composición visual, el color y la proporción en la creación artística y visual.'
            },
            'Educación Física': {
                'EF.C.E.1.3': 'Evaluar y mejorar el rendimiento deportivo, a partir del análisis de la condición física y las habilidades motrices.'
            }
        };

        function getRandomElement(obj) {
            const keys = Object.keys(obj);
            const randomKey = keys[Math.floor(Math.random() * keys.length)];
            return { key: randomKey, value: obj[randomKey] };
        }
        
        scheduleData.forEach(week => {
            let ce1, activity1, ce2, activity2;

            // Sesión 2
            const subject2 = week.session2.subject;
            const ceMap2 = ces[subject2];
            const activityMap2 = activityExamples[subject2];
            if (ceMap2 && activityMap2) {
                const randomCE = getRandomElement(ceMap2);
                ce2 = randomCE.key;
                activity2 = activityMap2[ce2];
            } else {
                ce2 = 'CE_EJEMPLO';
                activity2 = 'Actividad de razonamiento transversal';
            }
            week.session2.ce = ce2;
            week.session2.activity = activity2 || 'Actividad de razonamiento transversal';
            
            // Sesión 3
            const subject3 = week.session3.subject;
            const ceMap3 = ces[subject3];
            const activityMap3 = activityExamples[subject3];
            if (ceMap3 && activityMap3) {
                const randomCE = getRandomElement(ceMap3);
                ce3 = randomCE.key;
                activity3 = activityMap3[ce3];
            } else {
                ce3 = 'CE_EJEMPLO';
                activity3 = 'Actividad de razonamiento transversal';
            }
            week.session3.ce = ce3;
            week.session3.activity = activity3 || 'Actividad de razonamiento transversal';
        });

        // Función para alternar la visibilidad de las evaluaciones
        function toggleEvaluation(evaluationNumber) {
            const content = document.getElementById(`evaluation-content-${evaluationNumber}`);
            const icon = document.getElementById(`toggle-icon-${evaluationNumber}`);
            content.classList.toggle('hidden');
            if (content.classList.contains('hidden')) {
                icon.textContent = '+';
            } else {
                icon.textContent = '-';
            }
        }
        window.toggleEvaluation = toggleEvaluation;

        document.addEventListener('DOMContentLoaded', () => {
            const subjectFiltersContainer = document.getElementById('subject-filters');
            const ambitoFiltersContainer = document.getElementById('ambito-filters');
            const resetBtn = document.getElementById('reset-filters');
            
            const allSubjects = [...new Set(scheduleData.flatMap(w => [w.session1.subject, w.session2.subject, w.session3.subject]))].sort();
            const allAmbitos = [...new Set(subjects.map(s => s.ambito))].sort();

            function createFilterButtons(container, items, type) {
                items.forEach(item => {
                    const button = document.createElement('button');
                    button.textContent = item;
                    button.dataset.filter = item;
                    button.dataset.type = type;
                    button.className = 'filter-btn px-4 py-1.5 text-sm font-medium text-gray-700 bg-gray-100 rounded-full hover:bg-gray-200';
                    container.appendChild(button);
                });
            }

            function renderSchedule(data, containerId) {
                const container = document.getElementById(containerId);
                container.innerHTML = '';
                data.forEach(weekData => {
                    const weekCard = document.createElement('div');
                    weekCard.className = 'week-card bg-white rounded-2xl shadow-sm p-5';
                    weekCard.dataset.week = weekData.week;

                    const dates = getDatesForWeek(weekData.week);
                    const dateRange = `del ${dates.start} al ${dates.end}`;

                    weekCard.innerHTML = `
                        <h3 class="text-xl font-bold text-blue-700 mb-2">Semana ${weekData.week}</h3>
                        <p class="text-sm text-gray-500 mb-4">${dateRange}</p>
                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                            ${createSessionCard(weekData.session1, 1, weekData.week)}
                            ${createSessionCard(weekData.session2, 2, weekData.week)}
                            ${createSessionCard(weekData.session3, 3, weekData.week)}
                        </div>
                    `;
                    container.appendChild(weekCard);
                });
            }

            function createSessionCard(session, sessionNumber, weekNumber) {
                return `
                    <div class="session-card rounded-xl p-4 border border-gray-200 transition-all duration-300" 
                         data-subject="${session.subject}" data-ambito="${session.ambito}"
                         style="border-left: 5px solid ${subjectColors[session.subject] || '#6B7280'};">
                        <p class="font-semibold text-sm text-gray-500">Sesión ${sessionNumber}</p>
                        <p class="font-bold text-gray-800">${session.subject}</p>
                        <p class="text-sm text-gray-600 mt-2">${session.activity}</p>
                        <p class="text-xs text-gray-400 mt-3 font-mono">${session.ce}</p>
                        <div class="flex space-x-2 mt-4">
                            <button class="class-btn" onclick="openLink(${weekNumber}, ${sessionNumber}, '3ºA')">Evidencia 3ºA</button>
                            <button class="class-btn" onclick="openLink(${weekNumber}, ${sessionNumber}, '3ºB')">Evidencia 3ºB</button>
                        </div>
                    </div>
                `;
            }
            
            function applyFilter(filterValue, filterType) {
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active', 'bg-blue-700', 'text-white', 'hover:bg-blue-800'));
                const activeButton = document.querySelector(`.filter-btn[data-filter="${filterValue}"][data-type="${filterType}"]`);
                if (activeButton) {
                    activeButton.classList.add('active', 'bg-blue-700', 'text-white', 'hover:bg-blue-800');
                }

                document.querySelectorAll('.week-card').forEach(weekCard => {
                    let weekHasMatch = false;
                    weekCard.querySelectorAll('.session-card').forEach(sessionCard => {
                        const isMatch = sessionCard.dataset[filterType] === filterValue;
                        if (isMatch) {
                            sessionCard.classList.remove('opacity-40');
                            sessionCard.classList.add('highlight');
                            weekHasMatch = true;
                        } else {
                            sessionCard.classList.add('opacity-40');
                            sessionCard.classList.remove('highlight');
                        }
                    });
                    
                    if (weekHasMatch) {
                        weekCard.classList.remove('filtered-out');
                    } else {
                        weekCard.classList.add('filtered-out');
                    }
                });
            }

            function resetFilters() {
                document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active', 'bg-blue-700', 'text-white', 'hover:bg-blue-800'));
                document.querySelectorAll('.week-card').forEach(card => card.classList.remove('filtered-out'));
                document.querySelectorAll('.session-card').forEach(card => card.classList.remove('opacity-40', 'highlight'));
            }

            function renderChart() {
                const ctx = document.getElementById('proportionalityChart').getContext('2d');
                const sessionCounts = {};

                scheduleData.forEach(week => {
                    [week.session2, week.session3].forEach(session => {
                        sessionCounts[session.subject] = (sessionCounts[session.subject] || 0) + 1;
                    });
                });
                
                const sortedSubjects = Object.keys(sessionCounts).sort((a, b) => sessionCounts[b] - sessionCounts[a]);
                const labels = sortedSubjects;
                const data = sortedSubjects.map(subject => sessionCounts[subject]);
                const backgroundColors = sortedSubjects.map(subject => subjectColors[subject] || '#6B7280');

                new Chart(ctx, {
                    type: 'doughnut',
                    data: {
                        labels: labels,
                        datasets: [{
                            label: 'Nº de Sesiones',
                            data: data,
                            backgroundColor: backgroundColors,
                            borderColor: '#F8F9FA',
                            borderWidth: 3,
                            hoverOffset: 10
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    font: {
                                        family: 'Inter',
                                        size: 12
                                    },
                                    boxWidth: 15,
                                    padding: 15
                                }
                            },
                            tooltip: {
                                callbacks: {
                                    label: function(context) {
                                        let label = context.label || '';
                                        if (label) {
                                            label += ': ';
                                        }
                                        if (context.parsed !== null) {
                                            label += context.parsed + ' sesiones';
                                        }
                                        return label;
                                    }
                                }
                            }
                        }
                    }
                });
            }

            createFilterButtons(subjectFiltersContainer, allSubjects, 'subject');
            createFilterButtons(ambitoFiltersContainer, allAmbitos, 'ambito');
            
            renderSchedule(scheduleData.slice(0, 14), 'evaluation-content-1');
            renderSchedule(scheduleData.slice(14, 25), 'evaluation-content-2');
            renderSchedule(scheduleData.slice(25, 36), 'evaluation-content-3');

            renderChart();
            
            document.getElementById('controls').addEventListener('click', (e) => {
                if (e.target.classList.contains('filter-btn')) {
                    const { filter, type } = e.target.dataset;
                    applyFilter(filter, type);
                }
            });

            resetBtn.addEventListener('click', resetFilters);
        });
    </script>
</body>
</html>
